// –î–∞–Ω–Ω—ã–µ –¥–ª—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
const articles = [
    {
        id: 1,
        title: "–í—Ä–µ–¥ –∫—É—Ä–µ–Ω–∏—è –¥–ª—è —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã",
        category: "harm",
        description: "–ö–∞–∫ –∫—É—Ä–µ–Ω–∏–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–µ—Ä–¥—Ü–µ –∏ —Å–æ—Å—É–¥—ã, –∏ –∫–∞–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —ç—Ç–æ –∏–º–µ–µ—Ç –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è.",
        icon: "‚ù§Ô∏è",
        date: "15.05.2024",
        views: 1245
    },
    {
        id: 2,
        title: "–ú–µ—Ç–æ–¥ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–≥–∞—Ä–µ—Ç",
        category: "methods",
        description: "–ü–æ—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–∫–∞–∑—É –æ—Ç –∫—É—Ä–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Å–Ω–∏–∑–∏—Ç—å —Å—Ç—Ä–µ—Å—Å –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–º–∞.",
        icon: "üìâ",
        date: "12.05.2024",
        views: 987
    },
    {
        id: 3,
        title: "–ö–∞–∫ —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ —Å—Ç—Ä–µ—Å—Å–æ–º –±–µ–∑ —Å–∏–≥–∞—Ä–µ—Ç",
        category: "psychology",
        description: "–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–µ—Å—Å–æ–º –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –±—Ä–æ—Å–∞–µ—Ç –∫—É—Ä–∏—Ç—å.",
        icon: "üßò",
        date: "10.05.2024",
        views: 1567
    },
    {
        id: 4,
        title: "–ù–∏–∫–æ—Ç–∏–Ω–æ–≤–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å: –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –≤–∑–≥–ª—è–¥",
        category: "medicine",
        description: "–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω–∞ –æ –ø—Ä–∏—Ä–æ–¥–µ –Ω–∏–∫–æ—Ç–∏–Ω–æ–≤–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–ø–æ—Å–æ–±–∞—Ö –µ–µ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è.",
        icon: "üè•",
        date: "08.05.2024",
        views: 876
    },
    {
        id: 5,
        title: "–í–ª–∏—è–Ω–∏–µ –∫—É—Ä–µ–Ω–∏—è –Ω–∞ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É",
        category: "harm",
        description: "–ö–∞–∫ –∫—É—Ä–µ–Ω–∏–µ —Ä–∞–∑—Ä—É—à–∞–µ—Ç –ª–µ–≥–∫–∏–µ –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ä–∞–∑–≤–∏—Ç–∏—é —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π.",
        icon: "ü´Å",
        date: "05.05.2024",
        views: 1342
    },
    {
        id: 6,
        title: "–ù–∏–∫–æ—Ç–∏–Ω–∑–∞–º–µ—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è: –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã",
        category: "methods",
        description: "–û–±–∑–æ—Ä —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ù–ó–¢ –∏ –∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –±–æ—Ä—å–±–µ —Å –∫—É—Ä–µ–Ω–∏–µ–º.",
        icon: "üíä",
        date: "03.05.2024",
        views: 1109
    }
];

// –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
let user = {
    isLoggedIn: false,
    name: "",
    email: "",
    quitDate: null,
    progress: 0,
    diaryEntries: []
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    initNavigation();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
    initKnowledgeBase();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
    initCalculator();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
    initPersonalArea();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    initAuth();
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Ö–æ–¥–∞
    checkLoginStatus();
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
function initNavigation() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
    const navLinks = document.querySelectorAll('.nav-link, .footer-nav-link');
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const sectionId = this.getAttribute('data-section');
            showSection(sectionId);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            navLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
        });
    });
    
    // –ö–Ω–æ–ø–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mainNav = document.getElementById('mainNav');
    
    mobileMenuBtn.addEventListener('click', function() {
        mainNav.classList.toggle('active');
    });
    
    // –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –ø—É—Ç—å –∫ –∑–¥–æ—Ä–æ–≤—å—é"
    const startJourneyBtn = document.getElementById('startJourneyBtn');
    startJourneyBtn.addEventListener('click', function() {
        if (user.isLoggedIn) {
            showSection('personal');
        } else {
            showSection('auth');
            document.querySelector('.auth-tab[data-tab="register"]').click();
        }
    });
    
    // –ö–Ω–æ–ø–∫–∞ "–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ"
    const learnMoreBtn = document.getElementById('learnMoreBtn');
    learnMoreBtn.addEventListener('click', function() {
        showSection('knowledge');
    });
}

// –ü–æ–∫–∞–∑–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
function showSection(sectionId) {
    // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
    const sections = document.querySelectorAll('section');
    sections.forEach(section => {
        section.style.display = 'none';
    });
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.style.display = 'block';
        
        // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞—á–∞–ª—É —Ä–∞–∑–¥–µ–ª–∞
        window.scrollTo({
            top: targetSection.offsetTop - 80,
            behavior: 'smooth'
        });
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
function initKnowledgeBase() {
    const articlesContainer = document.getElementById('articlesContainer');
    const categoryButtons = document.querySelectorAll('.category-btn');
    
    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–∞—Ç–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    displayArticles('all');
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
    categoryButtons.forEach(button => {
        button.addEventListener('click', function() {
            // –£–¥–∞–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            categoryButtons.forEach(btn => btn.classList.remove('active'));
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
            this.classList.add('active');
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç–∞—Ç—å–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            displayArticles(this.dataset.category);
        });
    });
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–µ–π
    function displayArticles(category) {
        articlesContainer.innerHTML = '';
        
        const filteredArticles = category === 'all' 
            ? articles 
            : articles.filter(article => article.category === category);
        
        filteredArticles.forEach(article => {
            const articleCard = document.createElement('div');
            articleCard.className = 'article-card card';
            articleCard.innerHTML = `
                <div class="article-image">
                    <span>${article.icon}</span>
                </div>
                <div class="article-content">
                    <h3>${article.title}</h3>
                    <p>${article.description}</p>
                    <div class="article-meta">
                        <span><i class="far fa-calendar"></i> ${article.date}</span>
                        <span><i class="far fa-eye"></i> ${article.views}</span>
                    </div>
                    <button class="btn btn-primary" style="margin-top: 15px;">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ</button>
                </div>
            `;
            articlesContainer.appendChild(articleCard);
        });
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
function initCalculator() {
    const calculateBtn = document.getElementById('calculateBtn');
    calculateBtn.addEventListener('click', calculateSavings);
    
    const updateProgressBtn = document.getElementById('updateProgressBtn');
    updateProgressBtn.addEventListener('click', updateProgress);
}

// –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏–∏
function calculateSavings() {
    const cigarettesPerDay = parseInt(document.getElementById('cigarettesPerDay').value);
    const packPrice = parseInt(document.getElementById('packPrice').value);
    const cigarettesInPack = parseInt(document.getElementById('cigarettesInPack').value);
    
    const costPerCigarette = packPrice / cigarettesInPack;
    const dailyCost = cigarettesPerDay * costPerCigarette;
    const monthlyCost = dailyCost * 30;
    const yearlyCost = dailyCost * 365;
    
    const resultDiv = document.getElementById('result');
    document.getElementById('dailySavings').textContent = `–í –¥–µ–Ω—å: ${dailyCost.toFixed(2)} —Ä—É–±.`;
    document.getElementById('monthlySavings').textContent = `–í –º–µ—Å—è—Ü: ${monthlyCost.toFixed(2)} —Ä—É–±.`;
    document.getElementById('yearlySavings').textContent = `–í –≥–æ–¥: ${yearlyCost.toFixed(2)} —Ä—É–±.`;
    
    resultDiv.style.display = 'block';
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
function updateProgress() {
    const progressInput = document.getElementById('progressInput');
    const progressDays = parseInt(progressInput.value);
    const progressBar = document.getElementById('progressBar');
    const progressDaysLabel = document.getElementById('progressDays');
    
    if (progressDays >= 0 && progressDays <= 30) {
        const progressPercent = (progressDays / 30) * 100;
        progressBar.style.width = `${progressPercent}%`;
        progressDaysLabel.textContent = `${progressDays} –¥–Ω–µ–π`;
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user.progress = progressDays;
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
        if (user.isLoggedIn) {
            document.getElementById('daysWithoutSmoking').textContent = progressDays;
            document.getElementById('moneySaved').textContent = Math.round(progressDays * 75);
            document.getElementById('healthImprovement').textContent = `${Math.min(progressDays * 3, 100)}%`;
            document.getElementById('detailedProgressBar').style.width = `${progressPercent}%`;
        }
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
function initPersonalArea() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é
    const sidebarLinks = document.querySelectorAll('.sidebar-link');
    sidebarLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const tabId = this.getAttribute('data-tab');
            
            // –£–¥–∞–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫
            sidebarLinks.forEach(l => l.classList.remove('active'));
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π —Å—Å—ã–ª–∫–µ
            this.classList.add('active');
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            const targetTab = document.getElementById(tabId + 'Tab');
            if (targetTab) {
                targetTab.classList.add('active');
            }
        });
    });
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞—Ç—ã –æ—Ç–∫–∞–∑–∞
    const saveQuitDateBtn = document.getElementById('saveQuitDate');
    saveQuitDateBtn.addEventListener('click', function() {
        const quitDate = document.getElementById('quitDate').value;
        if (quitDate) {
            user.quitDate = quitDate;
            alert('–î–∞—Ç–∞ –æ—Ç–∫–∞–∑–∞ –æ—Ç –∫—É—Ä–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
            
            // –†–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–Ω–µ–π –±–µ–∑ –∫—É—Ä–µ–Ω–∏—è
            const today = new Date();
            const quit = new Date(quitDate);
            const diffTime = Math.abs(today - quit);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            document.getElementById('progressInput').value = diffDays;
            updateProgress();
        }
    });
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –¥–Ω–µ–≤–Ω–∏–∫–µ
    const saveDiaryEntryBtn = document.getElementById('saveDiaryEntry');
    saveDiaryEntryBtn.addEventListener('click', function() {
        const date = document.getElementById('diaryDate').value;
        const mood = document.getElementById('diaryMood').value;
        const cravings = document.getElementById('diaryCravings').value;
        const notes = document.getElementById('diaryNotes').value;
        
        if (date && notes) {
            const entry = {
                date,
                mood,
                cravings,
                notes
            };
            
            user.diaryEntries.push(entry);
            displayDiaryEntries();
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('diaryDate').value = '';
            document.getElementById('diaryMood').value = '3';
            document.getElementById('diaryCravings').value = '3';
            document.getElementById('diaryNotes').value = '';
            
            alert('–ó–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
        } else {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
        }
    });
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
    const saveSettingsBtn = document.getElementById('saveSettings');
    saveSettingsBtn.addEventListener('click', function() {
        alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
    });
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –¥–Ω–µ–≤–Ω–∏–∫–∞
function displayDiaryEntries() {
    const entriesList = document.getElementById('diaryEntriesList');
    entriesList.innerHTML = '';
    
    user.diaryEntries.forEach(entry => {
        const entryElement = document.createElement('div');
        entryElement.className = 'diary-entry card';
        
        const moodText = getMoodText(entry.mood);
        const cravingsText = getCravingsText(entry.cravings);
        
        entryElement.innerHTML = `
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <strong>${formatDate(entry.date)}</strong>
                <div>
                    <span>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: ${moodText}</span> | 
                    <span>–¢—è–≥–∞: ${cravingsText}</span>
                </div>
            </div>
            <p>${entry.notes}</p>
        `;
        
        entriesList.appendChild(entryElement);
    });
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–Ω–µ–≤–Ω–∏–∫–∞
function getMoodText(value) {
    const moods = {
        1: 'üò¢ –£–∂–∞—Å–Ω–æ–µ',
        2: 'üòî –ü–ª–æ—Ö–æ–µ',
        3: 'üòê –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ',
        4: 'üòä –•–æ—Ä–æ—à–µ–µ',
        5: 'üòÑ –û—Ç–ª–∏—á–Ω–æ–µ'
    };
    return moods[value] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
}

function getCravingsText(value) {
    const cravings = {
        1: '–û—á–µ–Ω—å —Å–ª–∞–±–∞—è',
        2: '–°–ª–∞–±–∞—è',
        3: '–°—Ä–µ–¥–Ω—è—è',
        4: '–°–∏–ª—å–Ω–∞—è',
        5: '–û—á–µ–Ω—å —Å–∏–ª—å–Ω–∞—è'
    };
    return cravings[value] || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
}

function formatDate(dateString) {
    const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
    return new Date(dateString).toLocaleDateString('ru-RU', options);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
function initAuth() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    const authTabs = document.querySelectorAll('.auth-tab');
    authTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');
            
            // –£–¥–∞–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
            authTabs.forEach(t => t.classList.remove('active'));
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ
            this.classList.add('active');
            
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ñ–æ—Ä–º—ã
            const authForms = document.querySelectorAll('.auth-form');
            authForms.forEach(form => form.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ñ–æ—Ä–º—É
            const targetForm = document.getElementById(tabId + 'Form');
            if (targetForm) {
                targetForm.classList.add('active');
            }
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ —à–∞–ø–∫–µ
    const loginBtn = document.getElementById('loginBtn');
    const registerBtn = document.getElementById('registerBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    
    loginBtn.addEventListener('click', function() {
        showSection('auth');
        document.querySelector('.auth-tab[data-tab="login"]').click();
    });
    
    registerBtn.addEventListener('click', function() {
        showSection('auth');
        document.querySelector('.auth-tab[data-tab="register"]').click();
    });
    
    logoutBtn.addEventListener('click', function() {
        user.isLoggedIn = false;
        user.name = "";
        user.email = "";
        checkLoginStatus();
        showSection('home');
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ñ–æ—Ä–º
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    
    loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
        if (email && password) {
            user.isLoggedIn = true;
            user.email = email;
            user.name = email.split('@')[0];
            checkLoginStatus();
            showSection('personal');
            
            // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            loginForm.reset();
        } else {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
        }
    });
    
    registerForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('regEmail').value;
        const password = document.getElementById('regPassword').value;
        const confirmPassword = document.getElementById('regConfirmPassword').value;
        
        if (!email || !password || !confirmPassword) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
            return;
        }
        
        if (password !== confirmPassword) {
            alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
            return;
        }
        
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
        user.isLoggedIn = true;
        user.email = email;
        user.name = email.split('@')[0];
        checkLoginStatus();
        showSection('personal');
        
        // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        registerForm.reset();
    });
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Ö–æ–¥–∞
function checkLoginStatus() {
    const loginBtn = document.getElementById('loginBtn');
    const registerBtn = document.getElementById('registerBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const personalNavLink = document.getElementById('personalNavLink');
    
    if (user.isLoggedIn) {
        loginBtn.style.display = 'none';
        registerBtn.style.display = 'none';
        logoutBtn.style.display = 'block';
        personalNavLink.style.display = 'block';
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
        document.getElementById('userName').textContent = user.name;
        document.getElementById('userEmail').textContent = user.email;
    } else {
        loginBtn.style.display = 'block';
        registerBtn.style.display = 'block';
        logoutBtn.style.display = 'none';
        personalNavLink.style.display = 'none';
    }
}